# 🔗 دليل ربط المشروع بـ Supabase

## 📌 الوضع الحالي
✅ السيرفر يعمل على Replit  
✅ ملفات المشروع جاهزة  
⚠️ تحتاج لإعداد قاعدة البيانات في Supabase

---

## 🚀 الخطوات المطلوبة

### المرحلة 1️⃣: إنشاء حساب وقاعدة بيانات Supabase

#### ✨ الخطوة 1: التسجيل
1. افتح: [https://supabase.com](https://supabase.com)
2. اضغط **"Start your project"** أو **"Sign Up"**
3. سجّل بـ GitHub (الأسهل) أو بالبريد الإلكتروني
4. **مجاني 100%** - لا حاجة لبطاقة ائتمان ✅

#### ✨ الخطوة 2: إنشاء المشروع
1. في لوحة التحكم، اضغط **"New Project"**
2. املأ المعلومات:
   ```
   Organization: اختر المنظمة
   Name: salon-younes
   Database Password: [اختر كلمة مرور قوية واحفظها!]
   Region: Europe (Central) - للجزائر ودول عربية
   Plan: Free (مجاني)
   ```
3. اضغط **"Create new project"**
4. انتظر 1-2 دقيقة ⏳

---

### المرحلة 2️⃣: إنشاء الجداول في قاعدة البيانات

#### ✨ الخطوة 3: تنفيذ السكريبت
1. في Supabase، اذهب إلى **"SQL Editor"** من القائمة اليسرى
2. اضغط **"+ New query"**
3. **ارجع لهذا المشروع في Replit**:
   - افتح ملف `database-schema.sql`
   - انسخ كامل محتوى الملف (Ctrl+A ثم Ctrl+C)
4. **ارجع لـ Supabase**:
   - الصق المحتوى في محرر SQL (Ctrl+V)
   - اضغط **"Run"** أو اضغط `Ctrl+Enter`
5. ستظهر رسالة **"Success. No rows returned"** ✅

#### ✨ الخطوة 4: التأكد من إنشاء الجداول
1. في Supabase، اذهب إلى **"Table Editor"** من القائمة اليسرى
2. يجب أن ترى 6 جداول:
   - ✅ bookings (الحجوزات)
   - ✅ cancelled_days (الأيام الملغاة)
   - ✅ announcements (الإعلانات)
   - ✅ journal (السجل)
   - ✅ income (الدخل)
   - ✅ debt (الديون)

---

### المرحلة 3️⃣: الحصول على مفاتيح الاتصال

#### ✨ الخطوة 5: نسخ المفاتيح
1. في Supabase، اذهب إلى **"Settings"** (الإعدادات) من القائمة اليسرى
2. اختر **"API"** من القائمة الفرعية
3. ستجد معلومتين مهمتين:

   📋 **Project URL** - مثل:
   ```
   https://abcdefghijk.supabase.co
   ```

   📋 **anon public** key - مفتاح طويل يبدأ بـ:
   ```
   eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
   ```

4. **انسخ هذين المفتاحين** (ستحتاجهما في الخطوة التالية)

---

### المرحلة 4️⃣: ربط المشروع بقاعدة البيانات

#### ✨ الخطوة 6: تحديث الإعدادات في Replit
1. **ارجع لمشروع Replit**
2. افتح ملف `js/supabase-config.js`
3. استبدل القيم بمفاتيحك:

   **قبل:**
   ```javascript
   const SUPABASE_CONFIG = {
     url: 'https://fphfwpqxdalhcmcgjawa.supabase.co',
     anonKey: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...',
     // ...
   };
   ```

   **بعد (بمفاتيحك الخاصة):**
   ```javascript
   const SUPABASE_CONFIG = {
     url: 'ضع Project URL هنا',
     anonKey: 'ضع anon public key هنا',
     // ...
   };
   ```

4. **احفظ الملف** (Ctrl+S)

---

## ✅ اختبار الاتصال

بعد تحديث الإعدادات:

1. افتح موقعك في Replit (اضغط زر ▶️ أو افتح المعاينة)
2. افتح **Developer Tools** في المتصفح:
   - Chrome/Edge: اضغط `F12`
   - أو انقر بزر الماوس الأيمن → "Inspect" → "Console"
3. ابحث عن رسالة: **"✅ تم تحميل البيانات بنجاح"**
4. يجب أن **تختفي** رسائل الأخطاء (Failed to fetch)

---

## 🎉 تم الربط بنجاح!

الآن يمكنك:
- ✅ إنشاء حجوزات جديدة
- ✅ عرض قائمة الحجوزات
- ✅ الدخول للوحة الإدارة (يونس/يونس)
- ✅ نشر إعلانات
- ✅ إدارة أيام العمل

---

## ⚠️ ملاحظات مهمة

### 🔒 الأمان
- **لا تشارك** anon key في أماكن عامة (لكن يمكن استخدامه في الكود لأنه مفتاح عام)
- **احفظ** Database Password في مكان آمن
- **غيّر** كلمة مرور الإدارة من لوحة التحكم

### 📊 الحد المجاني لـ Supabase
- **500 MB** مساحة قاعدة بيانات
- **طلبات غير محدودة** شهرياً
- **كافية** لصالون حلاقة عادي

---

## ❓ حل المشاكل

### المشكلة: "Failed to fetch" في Console
**الحل**: تأكد من:
1. نسخ المفاتيح بشكل صحيح (بدون مسافات)
2. تنفيذ سكريبت database-schema.sql في Supabase
3. المشروع في Supabase يعمل (ليس متوقف)

### المشكلة: "Table does not exist"
**الحل**: 
1. ارجع لـ SQL Editor في Supabase
2. نفّذ سكريبت database-schema.sql مرة أخرى

---

## 📞 للمساعدة
راجع ملف `SUPABASE_SETUP.md` للمزيد من التفاصيل

**Younes Ouladnoui - Coiffeur Professionnel** 💈
